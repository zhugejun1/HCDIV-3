<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Changi Area Property Analysis</title>  
    <script src="https://d3js.org/d3.v7.min.js"></script>  
    <script src="https://cdn.tailwindcss.com"></script>  
    <style>  
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');  
        body {  
            font-family: 'Poppins', sans-serif;  
            background: linear-gradient(135deg, #f6f8fc 0%, #f0f4f8 100%);  
        }  
        .axis text {  
            font-size: 12px;  
            font-weight: 500;  
        }  
        .axis path, .axis line {  
            stroke: #cbd5e1;  
        }  
        .grid line {  
            stroke: #e2e8f0;  
            stroke-dasharray: 2,2;  
        }  
        .tooltip {  
            position: absolute;  
            background: rgba(17, 24, 39, 0.95);  
            color: white;  
            padding: 1rem;  
            border-radius: 8px;  
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);  
            pointer-events: none;  
            display: none;  
            z-index: 1000;  
        }  
        .chart-container {  
            background: white;  
            border-radius: 16px;  
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);  
            position: relative;  
            overflow: hidden;  
        }  
        .chart-container::before {  
            content: '';  
            position: absolute;  
            top: 0;  
            left: 0;  
            right: 0;  
            height: 4px;  
            background: linear-gradient(90deg, #3b82f6, #ef4444);  
        }  
    </style>  
</head>  
<body class="min-h-screen py-12">  
    <div class="container mx-auto px-4">  
        <div class="max-w-4xl mx-auto">  
            <div class="text-center mb-8">  
                <h1 class="text-5xl font-bold mb-4">Singapore HDB Resale Prices</h1>  
            </div>  
            <div class="chart-container p-6">  
                <div id="chart" class="w-full"></div>  
                <div id="tooltip" class="tooltip"></div>  
            </div>  
        </div>  
    </div>  
    <script>  
        const formatCurrency = new Intl.NumberFormat('en-SG', {  
            style: 'currency',  
            currency: 'SGD',  
            minimumFractionDigits: 0  
        });  

        const data = [  
            { year: 2017, "CHANGI ROAD": 450000, "UPPER CHANGI ROAD": 480000 },  
            { year: 2018, "CHANGI ROAD": 470000, "UPPER CHANGI ROAD": 495000 },  
            { year: 2019, "CHANGI ROAD": 485000, "UPPER CHANGI ROAD": 510000 },  
            { year: 2020, "CHANGI ROAD": 495000, "UPPER CHANGI ROAD": 525000 },  
            { year: 2021, "CHANGI ROAD": 520000, "UPPER CHANGI ROAD": 550000 },  
            { year: 2022, "CHANGI ROAD": 550000, "UPPER CHANGI ROAD": 580000 },  
            { year: 2023, "CHANGI ROAD": 580000, "UPPER CHANGI ROAD": 610000 }  
        ];  

        function createChart() {  
            d3.select("#chart").selectAll("*").remove();  
            const container = document.getElementById('chart');  
            const width = container.clientWidth;  
            const height = Math.min(600, width * 0.6);  
            const margin = { top: 40, right: 120, bottom: 60, left: 80 };  
            const svg = d3.select("#chart").append("svg")  
                .attr("width", width)  
                .attr("height", height)  
                .attr("viewBox", `0 0 ${width} ${height}`);  

            const xScale = d3.scaleBand()  
                .domain(data.map(d => d.year))  
                .range([margin.left, width - margin.right])  
                .padding(0.2);  

            const yScale = d3.scaleLinear()  
                .domain([0, d3.max(data, d => Math.max(d['CHANGI ROAD'], d['UPPER CHANGI ROAD'])) * 1.1])  
                .range([height - margin.bottom, margin.top]);  

            // 添加条形图  
            data.forEach(d => {  
                // 显示 CHANGI ROAD 和 UPPER CHANGI ROAD 的柱状图  
                ['CHANGI ROAD', 'UPPER CHANGI ROAD'].forEach((location, i) => {  
                    svg.append("rect")  
                        .attr("x", xScale(d.year) + i * (xScale.bandwidth() / 2))  
                        .attr("y", yScale(d[location]))  
                        .attr("width", xScale.bandwidth() / 2)  
                        .attr("height", height - margin.bottom - yScale(d[location]))  
                        .attr("fill", i === 0 ? '#3b82f6' : '#ef4444')  
                        .on("mouseover", (event) => showTooltip(event, d, location))  
                        .on("mouseout", hideTooltip);  
                });  
            });  

            // 显示 X 和 Y 轴  
            svg.append("g")  
                .attr("transform", `translate(0,${height - margin.bottom})`)  
                .call(d3.axisBottom(xScale).tickSizeOuter(0));  
            
            svg.append("g")  
                .attr("transform", `translate(${margin.left},0)`)  
                .call(d3.axisLeft(yScale).ticks(6).tickFormat(formatCurrency.format));  
        }  

        // 显示 tooltip  
        function showTooltip(event, data, location) {  
            const tooltip = d3.select("#tooltip");  
            tooltip.style("display", "block")  
                   .style("left", (event.pageX + 10) + "px")  
                   .style("top", (event.pageY - 50) + "px")  
                   .html(`  
                        <div class="text-gray-300 text-xs">${data.year}</div>  
                        <div class="font-bold">${location}</div>  
                        <div class="text-lg">${formatCurrency.format(data[location])}</div>  
                   `);  
        }  

        // 隐藏 tooltip  
        function hideTooltip() {  
            d3.select("#tooltip").style("display", "none");  
        }  

        createChart();  
        window.addEventListener('resize', createChart);  
    </script>  
</body>  
</html>
